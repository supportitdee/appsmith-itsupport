{
  "gitSyncId": "67811a5458792a13d9b88165_2aabe37b-d583-4ab8-bd33-94dddc8b6202",
  "id": "Home_view_peraturan",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "WITH subbab_aggregated AS (\n    SELECT \n        s.ID_Bab,\n        STRING_AGG(\n            'Subbab ' || s.Nomor_Subbab || ': ' || s.Judul_Subbab || E'\\n' ||\n            COALESCE(s.Isi_Subbab, '') || E'\\n\\n' ||\n            STRING_AGG(\n                CASE \n                    WHEN pnj.Jenis_Konten = 'media' THEN '[Media] ' || pnj.Konten\n                    WHEN pnj.Jenis_Konten = 'text' THEN '[Text] ' || pnj.Konten\n                    ELSE '[Other] ' || pnj.Konten\n                END,\n                E'\\n' -- Pemisah antar Penjelasan\n                ORDER BY pnj.ID_Penjelasan\n            ),\n            E'\\n' -- Pemisah antar Subbab\n        ) AS subbab_dokumen\n    FROM view_peraturan_full s\n    LEFT JOIN view_peraturan_full pnj ON s.ID_Subbab = pnj.ID_Subbab\n    GROUP BY s.ID_Bab\n),\nbab_aggregated AS (\n    SELECT \n        b.ID_Peraturan,\n        STRING_AGG(\n            'Bab ' || b.Nomor_Bab || ': ' || b.Judul_Bab || E'\\n' ||\n            COALESCE(b.Isi_Bab, '') || E'\\n\\n' ||\n            subbab_aggregated.subbab_dokumen,\n            E'\\n\\n' -- Pemisah antar Bab\n            ORDER BY b.ID_Bab\n        ) AS bab_dokumen\n    FROM view_peraturan_full b\n    LEFT JOIN subbab_aggregated ON b.ID_Bab = subbab_aggregated.ID_Bab\n    GROUP BY b.ID_Peraturan\n)\nSELECT \n    'Peraturan: ' || vp.Judul_Peraturan AS judul_peraturan,\n    'Deskripsi: ' || vp.Deskripsi_Peraturan AS deskripsi_peraturan,\n    'Tanggal Diterbitkan: ' || TO_CHAR(vp.Tanggal_Diterbitkan, 'DD Mon YYYY') AS tanggal_diterbitkan,\n    bab_aggregated.bab_dokumen AS konten_dokumen\nFROM view_peraturan_full vp\nLEFT JOIN bab_aggregated ON vp.ID_Peraturan = bab_aggregated.ID_Peraturan\nGROUP BY vp.ID_Peraturan, vp.Judul_Peraturan, vp.Deskripsi_Peraturan, vp.Tanggal_Diterbitkan, bab_aggregated.bab_dokumen;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "db_peraturan_final",
      "isAutoGenerated": false,
      "name": "db_peraturan_final",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [],
    "executeOnLoad": false,
    "name": "view_peraturan",
    "pageId": "Home",
    "userSetOnLoad": false
  }
}